2009-03-16  Raphael 'kena' Poss  <r.c.poss@uva.nl>

	Improvements thanks to testing.
	
	* include/svp/roman.slh: Implement simple number printer which
	does not require divide.

	* include/svp/lib.slh: Expose "nop" as svp_nop.
	* doc/spec.txt: Update accordingly.

	* bin/slt: Better error handling. Try to handle signals more
	gracefully.
	
	* tests.mk: Missing from previous commit.
	
2009-03-16  Raphael 'kena' Poss  <r.c.poss@uva.nl>

	Extend test suite.

	* configure.ac,
	* Makefile.am: Add subdirectory "tests".
	
	* tests/Makefile.am: Capture TESTS_ENVIRONMENT to...	
	* tests.mk: here.

	* tests/mkalltests.sh: Generate TESTS variable automatically.
	* tests/Makefile.am: Use it.
	* bootstrap: Update accordingly.

	* tests/0_minimal/0_trivial/div.sl,
	* tests/0_minimal/0_trivial/emptymain.sl,
	* tests/0_minimal/0_trivial/if.sl,
	* tests/0_minimal/0_trivial/if2.sl,
	* tests/0_minimal/0_trivial/nop.sl,
	* tests/0_minimal/0_trivial/x_abort.sl,
	* tests/0_minimal/0_trivial/x_empty.sl,
	* tests/0_minimal/0_trivial/x_illinsn.sl,
	* tests/0_minimal/0_trivial/x_infloop.sl,
	* tests/0_minimal/0_trivial/x_invcpp.sl,
	* tests/0_minimal/0_trivial/x_invm4.sl,
	* tests/0_minimal/0_trivial/x_invsyntax.sl,
	* tests/0_minimal/0_trivial/x_undefsym.sl: Import from utcc.
	
2009-03-16  Raphael 'kena' Poss  <r.c.poss@uva.nl>

	Bug fixes thanks to testing.
	
	* demo/10threads.sl: Copy shared after sync to new temporary, to
	work around current bug in compiler.

	* include/svp/iomacros.slh: Initialize printf arguments using
	assignments instead of initializer, to prevent gcc from using
	'memset' behind the scenes. Make structure volatile so that the
	assignments are not optimized away.

	* include/svp/div.slh: Use software divide in all implementations
	by default.

	* include/svp/lib.slh: Fix definition of "unlikely".

	* lib/t-pppalpha/include/sl_support.h,	
	* bin/spp: Emit create during translation, as it needs intricate
	registers lists. Bark when "jsr" is found in the output.

	* lib/mtalpha-sim/include/svp_os.h: Insert "nop"'s before the halt
	instruction, as it causes a decode error in the pipeline and may
	cause a failure in the delay slot after a branch.

	* bin/slc.in: Use -Os by default instead of -O2.

	* bin/slt: Implement more.

	* tests/div.sl: Implement.
	
2009-03-16  Raphael 'kena' Poss  <r.c.poss@uva.nl>

	Start implementing slc test tools.
	
	* bin/timeout: Import from utcc.
	* bin/slt: Import from utcc (test1). Upgrade to slc interface.

	* bin/Makefile.am: Update accordingly.

	* demo/Makefile.am: Use the test system.

	* bin/slc.in: Document option -t.

2009-03-16  Raphael 'kena' Poss  <r.c.poss@uva.nl>

	Fix bug.
	
	* bin/spp: Rename zero registers after flattening, to catch them
	in prologue too.

2009-03-15  Raphael 'kena' Poss  <r.c.poss@uva.nl>

	Continue implementation of alternate "compiler". Now it can
	produce (possibly invalid) executable files. Use it for library
	and demo code.

	* bin/spp: Implement features.
	* bin/Makefile.am: Fix trailing whitespace.

	* lib/t-pppalpha/slimpl.m4,	
	* lib/t-pppalpha/include/sl_support.h: Remove swch from sync and
	create, as spp now adds it automatically.
	
	* configure.ac: Search for "ar" and "ranlib" from mtalpha
	binutils.

	* include/svp/lib.slh: Encapsulate __abort differently.

	* lib/div/divide.c: Copy to...
	* lib/svplib/div.sl: here; modify to use SL syntax.
	* lib/div/div.s: Remove, as is now compiled from source.

	* lib/mtalpha-sim/crt.s: Rename to...
	* lib/mtalpha-sim/slrt.s: here. Update to use MT register names.

	* lib/Makefile.am: Also build mtalpha library and crt; include
	div.sl into library for all targets.
	
	* demo/Makefile.am: Compile example code also using ppp compiler
	during check.

	* lib/svplib/io.sl: Let printf output the format character when it
	is unrecognized.

	* lib/r-mtalpha-sim: MGSim is now called MGAlpha.

2009-03-13  Raphael 'kena' Poss  <r.c.poss@uva.nl>

	Continue implementation of alternate "compiler".

	* bin/cce.bin: Clean up command line to "spp".
	
	* lib/t-pppalpha/slimpl.m4,
	* lib/t-pppalpha/include/sl_support.h,
	* bin/spp: Implement features.

2009-03-13  Raphael 'kena' Poss  <r.c.poss@uva.nl>

	* doc/spec.txt: Add missing reference to [utc2].

2009-03-13  Raphael 'kena' Poss  <r.c.poss@uva.nl>

	Upgrade the µTC-PTL back-end.
	
	* lib/t-ptl/include/sl_support.h: Allow to use an external PTL
	implementation.

	* lib/t-ptl/slimpl.m4,
	* lib/host-host-ptl/ptl_debug.cc,
	* lib/host-host-ptl/ptl_svp.cc,
	* lib/host-host-ptl/ptl_vars.cc,
	* lib/host-host-ptl/include/create.tpl,
	* lib/host-host-ptl/include/template.pl,
	* lib/host-host-ptl/include/ptl_debug.h,
	* lib/host-host-ptl/include/ptl_svp.h,
	* lib/host-host-ptl/include/ptl_vars.h,
	* lib/host-host-ptl/include/ptl_deps.h: Update to latest utc-ptl code.

2009-03-13  Raphael 'kena' Poss  <r.c.poss@uva.nl>

	Clean up code.
	
	* include/slc.m4: Make sl_proccall a statement, not an expression.
	
	* include/lib/iomacros.slh: Simplify wrapper macros since
	sl_proccall already encapsulate the argument declarations in a
	scope.
	
2009-03-12  Raphael 'kena' Poss  <r.c.poss@uva.nl>

	Add missing macro definitions.
	
	* lib/t-ptl/slimpl.m4,
	* lib/t-seqc/slimpl.m4,
	* lib/t-utc0/slimpl.m4,	
	* lib/t-utc/slimpl.m4: Add missing definition of "f"
	parameter/argument declarations.

2009-03-12  Raphael 'kena' Poss  <r.c.poss@uva.nl>

	Clean up code.
	
	* lib/svplib/io.sl, 
	* include/svp/io.slh,	
	* include/svp/iomacros.slh: Use the "f" parameter/argument form
	where applicable.

	* doc/spec.txt: Fix typo.

2009-03-12  Raphael 'kena' Poss  <r.c.poss@uva.nl>

	More language specification, as requested by UH.
	
	* doc/spec.txt: List external document references. Add
	glossary. Clarify thread function type compatibility. List
	referenced CSA notes explicitly. Add missing definition of SVP
	constants. Include io.slh and iomacros.slh litterally to document
	the library. Document svp_assert better. Document svp/lib.slh.

	* doc/Makefile.am: Update accordingly.
	
	* include/std/io.slh: Document.

	* include/std/assert.slh,
	* include/std/iomacros.slh: Clean up macros.
	
	* include/std/io.slh: Move argslot definition to...
	* include/std/argslot.slh: here.
	* include/cstddef.slh,
	* include/cstdint.slh: Implement.

	* Makefile.am: Update accordingly.
	
2009-03-11  Raphael 'kena' Poss  <r.c.poss@uva.nl>

	Code cleanup. Add more svn:ignore patterns.
	
	* bin/Makefile.am (cce sgr slc): Remove extraneous use of mkdir.

2009-03-11  Raphael 'kena' Poss  <r.c.poss@uva.nl>

	More documentation.
	
	* doc/README.txt: Update with additional references.
	
	* doc/NEWS.txt: Document last two batches of major changes.
	
	* doc/HACKING.txt: Document maintainer mode. Document additional
	requirements for developer. Document using scripts without
	installing. Document distribution.

	* doc/lang.txt: Remove section about library since this is now
	covered by the separate specification.

	* Makefile.am (NEWS): Copy from src/NEWS.txt.

2009-03-11  Raphael 'kena' Poss  <r.c.poss@uva.nl>

	Add missing directory creation in maintainer mode.
	
 	* Makefile.am (include/slc_*.m4): Create the "include" directory
	in case it was not created before.

2009-03-11  Raphael 'kena' Poss  <r.c.poss@uva.nl>

	Correct paths in included dirs.
	
	* bin/Makefile.am (edit_inst): Use $(includedir), not $(incdir).

2009-03-11  Raphael 'kena' Poss  <r.c.poss@uva.nl>

	Clarify language spec.
	
	* doc/spec.txt: Rephrase break type properly. Place restriction on
	contents of "create".
	
2009-03-11  Raphael 'kena' Poss  <r.c.poss@uva.nl>

	Add formal language specification.
	
	* doc/spec.txt: Add.
	* doc/Makefile.am: Update accordingly.

2009-03-09  Raphael 'kena' Poss  <r.c.poss@uva.nl>

	Remove the C preprocessor from the set of usable
	SL features.
	
	* doc/lang.txt: Document use of m4 preprocessor.

	* include/slc.m4: Remove definition of sl_include: since we
	officially advertise m4 there is no need to hide m4_include. Push
	definition of sl_proccall to after initialization.

	* bin/spp, 
	* lib/t-pppalpha/slimpl.m4: Escape quotes in C before sending to
	shell; be careful with extra ':' characters.

	* lib/t-ptl/slimpl.m4,
	* lib/t-seqc/slimpl.m4: Allow for global initializers containing
	":".

	* include/svp/div.slh,
	* include/svp/io.slh,
	* include/svp/assert.slh,
	* include/svp/iomacros.slh: 
	* include/svp/lib.slh: Use m4 macros instead of CPP.

	* bin/cce.in: Put -DHAVE_C_DIVIDE in tflags instead of ppflags
	since it is now used during translation.

	* include/svp/io.slh: Remove printfN macros; replace by a single
	printf macro definition which supports a variable argument list.
	
	* demo/10threads.sl,
	* demo/helloworld.sl,
	* demo/answer.sl,
	* demo/test.sl: Update accordingly. Avoid commas in text strings
	since we are not quoting macro arguments to keep code simple.	

2009-03-08  Raphael 'kena' Poss  <r.c.poss@uva.nl>

	Migrate fibonacci example to sl-apps.
	
	* demo/fibo.sl: Remove.
	* demo/fibonacci.sl: Link from sl-apps.
	* demo/Makefile.am: Update accordingly.

2009-03-08  Raphael 'kena' Poss  <r.c.poss@uva.nl>

	* bin/spp,
	* lib/t-pppalpha/slimpl.m4,	
	* lib/t-pppalpha/include/sl_support.h: Advance implementation of
	create.

2009-03-06  Raphael 'kena' Poss  <r.c.poss@uva.nl>

	Cleanup & bugfix.
	
	* configure.ac: Configure Python.
	* bin/cce.in,
	* bin/Makefile.am,
	* lib/t-pppalpha/slimpl.m4: Use configured Python.

	* lib/t-pppalpha/include/sl_support.h,
	* bin/spp: Remove family tag from argument names (they should all
	be in the same namespace).

	* bin/spp (pppalpha.makedic): Kill unused function.

2009-03-06  Raphael 'kena' Poss  <r.c.poss@uva.nl>

	Start implementing ppp "compiler".

	* lib/t-pppalpha/slimpl.m4: Add.
	* lib/t-pppalpha/include/sl_support.h: Add.
	* lib/Makefile.am (nobase_dist_pkgdata_DATA): Update accordingly.

	* bin/spp: Add.
	* bin/Makefile.am (dist_bin_SCRIPTS): Update accordingly.

2009-03-06  Raphael 'kena' Poss  <r.c.poss@uva.nl>

	Re-organize layout of sl_support.h.

	* lib/host-host-ptl/include/sl_support.h: Rename to...
	* lib/t-ptl/include/sl_support.h: ...here.

	* lib/host-host-seqc/include/sl_support.h: Rename to...
	* lib/t-seqc/include/sl_support.h: ...here.

	* lib/mtalpha-sim/include/sl_support.h: Rename to...
	* lib/t-utc0/include/sl_support.h: ...here.

	* lib/Makefile.am (nobase_dist_pkgdata_DATA): Update accordingly.

	* bin/cce.in (slc_ppflags): Add include/ subdirectory of
	translator to preprocessor search list.

	* lib/host-host-seqc/slrt.c: Update accordingly.

2009-03-06  Raphael 'kena' Poss  <r.c.poss@uva.nl>

	Complete previous commit; add bootstrap
	script to initialize the dev environment.
	
	* Makefile.am: Update after upgrade of m4sugar.
	* bootstrap: Add.

2009-03-06  Raphael 'kena' Poss  <r.c.poss@uva.nl>

	Upgrade m4sugar.
	
	* include/slc.m4: Implement m4_step. Use m4_wrap_lifo to fix
	undivert order.

	* include/m4sugar.m4: Upgrade from Autoconf 2.59.
	* include/m4sugar_version.m4: Add.
	* include/m4sugar_foreach.m4: Add.
	* include/m4sugar_transform.sed: Update accordingly.
	
2009-03-02  Raphael 'kena' Poss  <r.c.poss@uva.nl>

	Start using m4sugar.
	
	* include/m4sugar_transform.sed: Rename dnl to m4_dnl. Remove
	dependency on m4sugar's version.m4.

	* bin/slc.in: Make "cce" in charge of loading the m4 files.
	* bin/cce.in: Modify accordingly.
	
	* include/slc.m4: Modify to use m4sugar; initialize diversions
	properly. Change comment style to C++ (//). Load
	implementation-specific macros from "slimpl.m4" instead of
	"protoimpl.m4".

	* lib/t-seqc/protoimpl.m4: Rename to...
	* lib/t-seqc/slimpl.m4: here.

	* lib/t-ptl/protoimpl.m4: Rename to...
	* lib/t-ptl/slimpl.m4: here.

	* lib/t-utc/protoimpl.m4: Rename to...
	* lib/t-utc/slimpl.m4: here.

	* lib/t-utc0/protoimpl.m4: Rename to...
	* lib/t-utc0/slimpl.m4: here.

	* lib/Makefile.am: Modify accordingly.

	* lib/t-seqc/slimpl.m4,
	* lib/t-ptl/slimpl.m4,
	* lib/t-utc/slimpl.m4,	
	* lib/t-utc0/slimpl.m4: Start using m4sugar: use m4_if and
	m4_bregexp instead of m4_ifelse and m4_regexp.

2009-03-02  Raphael 'kena' Poss  <r.c.poss@uva.nl>

	* doc/lang.txt: Add.
	
	* doc/Makefile.am: Update accordingly. Set MAINTAINERCLEANFILES.

2009-03-02  Raphael 'kena' Poss  <r.c.poss@uva.nl>

	* bin/Makefile.am (edit_inst, edit_src): Substitute @incdir@.

	* bin/slc.in: Use @incdir@.
	
2009-03-02  Raphael 'kena' Poss  <r.c.poss@uva.nl>

	* lib/Makefile.am: Distribute t-utc, t-utc0,
	r-mtalpha-sim. Reorganize targets to separate data
	stuff (pkgdatadir) from libraries and objects (libdir).

	* lib/host-host-ptl/slrt.c,
	* lib/host-host-seqc/slrt.c: Prevent compiler from optimizing away
	__tag__.

	* bin/sgr.in: Kill $root (was unused). Use Bash explicitly to run
	the runner script.

	* lib/r-host: Fix handling of relative paths. 

	* bin/cce.in: Fix splitting of build dir and source dir (again).

	* bin/Makefile.am: Propagate more directory variables to scripts.
	
2009-03-02  Raphael 'kena' Poss  <r.c.poss@uva.nl>

	* configure.ac: Remove spurious reference to "include/Makefile".

2009-03-01  Raphael 'kena' Poss  <r.c.poss@uva.nl>

	* ChangeLog: initialize.

	* configure.ac: Check for CC, CXX, RANLIB, perl.

	* doc/README.txt: Add.
	* doc/Makefile.am,
	* Makefile.am: Change accordingly.

	* include/Makefile.am: move contents to...
	* Makefile.am: here, so that the include/ base is kept during
	install.

	* lib/Makefile.am: Add.
	* configure.ac: Change accordingly.
	* lib/host-host-seqc/Makefile,
	* lib/host-host-ptl/Makefile,
	* lib/host-host-ptl/include/Makefile: Remove, as is now obsolete.

	* lib/host-host-ptl/crt.c: Rename to...
	* lib/host-host-ptl/slcrt.c: here.

	* lib/host-host-seqc/crt.c: Rename to...
	* lib/host-host-seqc/slcrt.c: here.

	* demo/Makefile.am: Distribute more demos. Compile each demo for
	multiple targets.

	* bin/cce.in: Allow for includes spread over separate source dir
	and build dir.
